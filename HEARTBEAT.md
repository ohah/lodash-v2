# Heartbeat — lodash-v2 셀프 피드백

이 파일을 읽고 아래 항목을 **한 턴 안에서** 순서대로 처리하세요.  
할 일이 없으면 `HEARTBEAT_OK` 만 답하세요.

**대상:** 이 워크스페이스(**lodash-v2**). 체크·작업은 모두 이 레포 루트 기준으로 실행하세요.

---

## 에러 시 재시도 및 사용자 알림

- **재시도**: 어떤 단계(테스트·벤치마크·generate-feedback·git 등) 실행 중 에러가 나면, **같은 작업을 최대 3번까지 재시도**하세요.
- **3번 재시도 후에도 동일한 에러**가 나면:
  1. **디스코드로 알림**을 보내세요.  
     - 메시지 도구 사용 시 **target(채널 ID)을 반드시 지정**하세요.  
     - 보낼 내용 예:  
       `[lodash-v2 Heartbeat] 작업 실패 (3회 재시도 후 동일 에러)\n작업: <실행한 명령/단계>\n에러: <에러 메시지 요약>\n피드백 주시면 다음 턴에서 반영해 해결하겠습니다.`
  2. 이번 턴에서는 **HEARTBEAT_OK 대신** 위 알림을 보낸 뒤, "사용자 피드백 대기" 상태로 끝내세요.
- **다음 턴에서 사용자 피드백 반영**:  
  디스코드(또는 사용자가 남긴 지시)에 피드백이 있으면, 그 내용에 따라 수정·재실행한 뒤 다시 체크리스트를 진행하세요. 피드백이 없으면 평소처럼 체크리스트만 진행합니다.

**디스코드 채널 ID** (필요 시 사용): OpenClaw에서 하트비트/알림용으로 쓰는 채널. 설정에 따라 다름. 예: `1470349655966744661` (동일 채널 쓸 경우).

---

## 매 턴 디스코드 알림 (필수)

**매 턴마다** 아래 두 번 디스코드로 알림을 보내세요. 메시지 도구 사용 시 **target(채널 ID)을 반드시 지정**하세요.

1. **턴 시작 직후**  
   - 예: `[lodash-v2 Heartbeat] 시작` 또는 이번 턴에서 할 일 한 줄 요약.

2. **턴 끝나기 전 (응답 보내기 직전)**  
   - 이번 턴에서 **한 작업들 요약**을 디스코드로 보내세요.  
   - 예: `[lodash-v2 Heartbeat] 완료 — 동등성 테스트 N/N 통과, 벤치마크 실행, generate-feedback, 커밋 없음` 또는 수행한 작업·결과를 한두 줄로 요약.

---

## 매 턴 체크리스트

1. **결과 동등성 테스트**
   - `bun test packages/benchmark/src/__tests__/result-equivalence.test.ts`
   - 실패가 있으면 `docs/BENCHMARK_AND_RESULT_FEEDBACK.md` 참고해 `packages/core/src/*.ts` 수정.
   - **필요한 테스트코드**(케이스·describe)가 있으면 진행하면서 **계속 추가** (동등성 유지).

2. **벤치마크**
   - `bun run benchmark`
   - `fastest`가 `ours`가 아니면 해당 함수 구현 점검.

3. **피드백 보고서 갱신**
   - `bun run generate-feedback`
   - `docs/feedback-report.md`(또는 스크립트가 쓰는 경로)의 "셀프 피드백 체크리스트"대로 진행.

4. **변경 분 커밋(선택)**
   - 변경이 있으면 `git status` 확인 후 add → commit (필요 시 push). 턴 끝나기 전에 실행.

---

## 참고 문서

- **해석 가이드**: `docs/BENCHMARK_AND_RESULT_FEEDBACK.md`
- **최신 실패/벤치 요약**: `bun run generate-feedback` 후 생성되는 피드백 보고서

---

응답 보내기 전: [ ] 턴 시작 직후 디스코드 알림 보냄? [ ] 결과 동등성 테스트 확인 [ ] 벤치마크 실행 [ ] generate-feedback 실행 [ ] 필요 시 수정·커밋 [ ] 턴 끝나기 전 디스코드에 이번 턴 작업 요약 보냄? [ ] 에러 3회 재시도 후 동일 시 → 디스코드 알림 보냄? [ ] 이전 턴에서 사용자 피드백 있으면 반영함?  
위를 모두 했을 때만 `HEARTBEAT_OK` 또는 이번 턴 요약을 보내세요. (3회 재시도 후 동일 에러면 HEARTBEAT_OK 대신 디스코드 알림 후 사용자 피드백 대기로 끝냄.)
